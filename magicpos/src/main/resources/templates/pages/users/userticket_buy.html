<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/user/main_layout}">
<head>
    <link rel="stylesheet" th:href="@{/css/userticket_buy.css}">
</head>
<body layout:fragment="content">
    <div class="container">
        <div class="main-panel">
            <div class="ticket_con">   
                <h2>요금제 구매</h2>
                <div class="plan-grid">
                    <div class="plan-card" 
                         th:each="ticket : ${ticketList}"
                         th:data-name="'회원 ' + ${ticket.price} + '원권'"
                         th:data-price="${ticket.price}"
                         th:data-time="${ticket.time}">
                        <div class="plan-title" th:text="'회원 ' + ${#numbers.formatInteger(ticket.price, 0)} + '원권'"></div>
                        <div class="plan-info">
                            <div class="plan-time" th:text="${ticket.time} + ':00'">00:00</div>
                            <div class="plan-price" th:text="${#numbers.formatInteger(ticket.price, 0)} + '원'">1,000원</div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <div class="side-panel">
            <div class="side-con">
                <div class="remaintime-info">
                        <span class="remain-info-text">잔여시간</span>
                        <span class="remain-info-time">10:40</span>
                </div>
    
                <!-- 주문 폼 시작 -->
                <div class="ticket-section">
                    <div class="ticket-item">

                    </div>
               </div>

            </div>

            <!-- 주문 폼은 cart-section 아래에 위치, cartList 정보를 hidden input으로 전달 -->
            <form id="orderForm" action="/orders/create" method="post">
                <input type="hidden" name="seatId" th:value="${usageInfo.seat_id}" />
                <div th:each="cart, cartStat : ${cartList != null ? cartList : {}}">
                    <input type="hidden" name="pNoList" th:value="${cart.p_no}" />
                    <input type="hidden" name="quantityList" th:value="${cart.quantity}" />
                    <input type="hidden" name="pNameList" th:value="${cart.p_name}" />
                </div>
                <input type="hidden" name="totalPrice" th:value="${totalPrice}" />
                <div class="payment-methods">
                    <label><input type="radio" name="payment" value="현금" required>현금</label>
                    <label><input type="radio" name="payment" value="카드">신용카드</label>
                </div>

                <div class="cash-options">
                    <div class="cash-quick">
                        <label><input type="radio" name="cash" value="50000" class="cash-option">5만원</label>
                        <label><input type="radio" name="cash" value="10000" class="cash-option">1만원</label>
                        <label><input type="radio" name="cash" value="5000" class="cash-option">5천원</label>
                        <label><input type="radio" name="cash" value="1000" class="cash-option">1천원</label>
                    </div>
                    <div class="cash-custom">
                        <label><input type="radio" name="cash" value="auto" class="cash-option">금액에 맞게</label>
                        <label><input type="radio" name="cash" value="manual" class="cash-option">직접 입력</label>
                        <input type="text" name="cashManual" />
                    </div>
                </div>
                <input type="text" class="request-input" name="message" maxlength="50" placeholder="요청사항은 50자 까지 입력할 수 있습니다.">
                <button class="order-button" type="submit">주문하기</button>
            </form>
            <!-- 주문 폼 끝 -->
        </div>
    </div>

    <script src="/js/userticket_buy.js"></script>
</body>
</html>
